<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HE Shop - Heat Exchanger Inventory Management</title>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        [x-cloak] { display: none !important; }
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            animation: fadeIn 0.3s, fadeOut 0.3s 2.7s forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-20px); }
        }
    </style>
</head>
<body class="bg-gray-50" x-data="inventoryApp()">
    <!-- Toast Notifications -->
    <div x-show="toast.visible" 
         x-transition.duration.300ms
         @click="toast.visible = false"
         :class="{'bg-green-500': toast.type === 'success', 'bg-red-500': toast.type === 'error', 'bg-blue-500': toast.type === 'info'}"
         class="toast text-white p-4 rounded-lg shadow-lg cursor-pointer">
        <div class="flex items-center">
            <i :class="{'bi-check-circle-fill': toast.type === 'success', 'bi-exclamation-circle-fill': toast.type === 'error', 'bi-info-circle-fill': toast.type === 'info'}" class="mr-2"></i>
            <span x-text="toast.message"></span>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="bg-blue-600 text-white p-4">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold">HE Shop Inventory</h1>
            <div class="flex items-center">
                <span class="hidden md:inline-block mr-4">Heat Exchanger Specialists</span>
                <button @click="toggleSidebar" class="lg:hidden">
                    <i class="bi bi-list text-2xl"></i>
                </button>
            </div>
        </div>
    </nav>

    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <div x-cloak :class="{'hidden': !sidebarOpen, 'block': sidebarOpen}" 
             class="fixed lg:static lg:block bg-white w-64 h-full shadow-lg slide-in z-10">
            <div class="p-4">
                <div class="space-y-4">
                    <button @click="currentView = 'inventory'; sidebarOpen = window.innerWidth < 1024 ? false : sidebarOpen" 
                            :class="{'bg-blue-100': currentView === 'inventory'}"
                            class="w-full text-left p-2 hover:bg-blue-50 rounded flex items-center gap-2">
                        <i class="bi bi-box-seam"></i> Inventory
                    </button>
                    <button @click="currentView = 'add'; editingItem = null; resetForm(); sidebarOpen = window.innerWidth < 1024 ? false : sidebarOpen" 
                            :class="{'bg-blue-100': currentView === 'add' && !editingItem}"
                            class="w-full text-left p-2 hover:bg-blue-50 rounded flex items-center gap-2">
                        <i class="bi bi-plus-circle"></i> Add Item
                    </button>
                    <button @click="currentView = 'reports'; generateReports(); sidebarOpen = window.innerWidth < 1024 ? false : sidebarOpen" 
                            :class="{'bg-blue-100': currentView === 'reports'}"
                            class="w-full text-left p-2 hover:bg-blue-50 rounded flex items-center gap-2">
                        <i class="bi bi-graph-up"></i> Reports
                    </button>
                    <button @click="currentView = 'bulk'; sidebarOpen = window.innerWidth < 1024 ? false : sidebarOpen" 
                            :class="{'bg-blue-100': currentView === 'bulk'}"
                            class="w-full text-left p-2 hover:bg-blue-50 rounded flex items-center gap-2">
                        <i class="bi bi-arrow-down-up"></i> Bulk Operations
                    </button>
                    <hr class="my-3">
                    <button @click="currentView = 'settings'; sidebarOpen = window.innerWidth < 1024 ? false : sidebarOpen" 
                            :class="{'bg-blue-100': currentView === 'settings'}"
                            class="w-full text-left p-2 hover:bg-blue-50 rounded flex items-center gap-2">
                        <i class="bi bi-gear"></i> Settings
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-6 overflow-x-hidden">
            <!-- Loading Overlay -->
            <div x-show="loading" 
                 class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white p-5 rounded-lg flex flex-col items-center">
                    <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-500 mb-4"></div>
                    <p class="text-gray-700">Loading...</p>
                </div>
            </div>

            <!-- Inventory View -->
            <div x-show="currentView === 'inventory'" class="space-y-4">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                    <h2 class="text-2xl font-semibold">Inventory Items</h2>
                    <div class="flex flex-col sm:flex-row gap-2 w-full md:w-auto">
                        <div class="relative flex-1">
                            <input type="text" x-model="searchQuery" 
                                @input="debounceSearch()"
                                placeholder="Search items..." 
                                class="border p-2 rounded pl-10 w-full">
                            <i class="bi bi-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                        <select x-model="filterStatus" @change="applyFilters()" class="border p-2 rounded">
                            <option value="all">All Status</option>
                            <option value="in-stock">In Stock</option>
                            <option value="low-stock">Low Stock</option>
                            <option value="out-of-stock">Out of Stock</option>
                        </select>
                        <button @click="refreshInventory" 
                                class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 flex items-center justify-center gap-2">
                            <i class="bi bi-arrow-clockwise"></i>
                            <span class="hidden sm:inline">Refresh</span>
                        </button>
                    </div>
                </div>

                <!-- Empty state -->
                <div x-show="filteredItems.length === 0" class="bg-white rounded-lg shadow-md p-8 text-center">
                    <i class="bi bi-inbox text-5xl text-gray-400 mb-4 block"></i>
                    <h3 class="text-xl font-medium text-gray-700 mb-2">No inventory items found</h3>
                    <p class="text-gray-500 mb-6" x-text="searchQuery ? 'No items match your search criteria' : 'Add your first inventory item to get started'"></p>
                    <button @click="currentView = 'add'; resetForm()" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600">
                        <i class="bi bi-plus-circle mr-2"></i> Add New Item
                    </button>
                </div>

                <div class="overflow-x-auto" x-show="filteredItems.length > 0">
                    <table class="min-w-full bg-white shadow-md rounded">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="p-3 text-left cursor-pointer" @click="sortItems('id')">
                                    ID <i :class="{'bi-arrow-up': sortField === 'id' && sortDirection === 'asc', 'bi-arrow-down': sortField === 'id' && sortDirection === 'desc'}" class="text-xs"></i>
                                </th>
                                <th class="p-3 text-left cursor-pointer" @click="sortItems('name')">
                                    Name <i :class="{'bi-arrow-up': sortField === 'name' && sortDirection === 'asc', 'bi-arrow-down': sortField === 'name' && sortDirection === 'desc'}" class="text-xs"></i>
                                </th>
                                <th class="p-3 text-left cursor-pointer" @click="sortItems('quantity')">
                                    Quantity <i :class="{'bi-arrow-up': sortField === 'quantity' && sortDirection === 'asc', 'bi-arrow-down': sortField === 'quantity' && sortDirection === 'desc'}" class="text-xs"></i>
                                </th>
                                <th class="p-3 text-left">Status</th>
                                <th class="p-3 text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="item in filteredItems" :key="item.id">
                                <tr class="border-t hover:bg-gray-50">
                                    <td class="p-3" x-text="item.id"></td>
                                    <td class="p-3" x-text="item.name"></td>
                                    <td class="p-3">
                                        <div class="flex items-center gap-2">
                                            <span x-text="item.quantity"></span>
                                            <button @click="quickUpdateQuantity(item, 1)" class="text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded hover:bg-green-200" title="Increase quantity">
                                                +1
                                            </button>
                                            <button @click="quickUpdateQuantity(item, -1)" 
                                                    :disabled="item.quantity <= 0"
                                                    :class="{'opacity-50 cursor-not-allowed': item.quantity <= 0}"
                                                    class="text-xs bg-red-100 text-red-700 px-1.5 py-0.5 rounded hover:bg-red-200" title="Decrease quantity">
                                                -1
                                            </button>
                                        </div>
                                    </td>
                                    <td class="p-3">
                                        <span :class="{
                                            'bg-green-100 text-green-800': item.quantity > 10,
                                            'bg-yellow-100 text-yellow-800': item.quantity <= 10 && item.quantity > 0,
                                            'bg-red-100 text-red-800': item.quantity === 0
                                        }" class="px-2 py-1 rounded-full text-sm">
                                            <span x-text="item.quantity > 10 ? 'In Stock' : item.quantity === 0 ? 'Out of Stock' : 'Low Stock'"></span>
                                        </span>
                                    </td>
                                    <td class="p-3 text-right">
                                        <button @click="editItem(item)" 
                                                class="text-blue-500 hover:text-blue-700 bg-blue-50 p-1.5 rounded-full hover:bg-blue-100">
                                            <i class="bi bi-pencil"></i>
                                        </button>
                                        <button @click="deleteItem(item.id)" 
                                                class="text-red-500 hover:text-red-700 bg-red-50 p-1.5 rounded-full hover:bg-red-100 ml-1">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                        <button @click="viewItemDetails(item)" 
                                                class="text-gray-500 hover:text-gray-700 bg-gray-50 p-1.5 rounded-full hover:bg-gray-100 ml-1">
                                            <i class="bi bi-info-circle"></i>
                                        </button>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                    
                    <!-- Pagination -->
                    <div class="mt-4 flex justify-between items-center">
                        <span class="text-sm text-gray-600" x-text="`Showing ${filteredItems.length} of ${inventoryItems.length} items`"></span>
                        <div class="flex gap-1">
                            <button @click="currentPage = Math.max(1, currentPage - 1)" 
                                    :disabled="currentPage === 1"
                                    :class="{'opacity-50 cursor-not-allowed': currentPage === 1}"
                                    class="px-3 py-1 border rounded hover:bg-gray-100">
                                <i class="bi bi-chevron-left"></i>
                            </button>
                            <template x-for="page in totalPages" :key="page">
                                <button @click="currentPage = page" 
                                        :class="{'bg-blue-500 text-white': currentPage === page, 'hover:bg-gray-100': currentPage !== page}"
                                        class="px-3 py-1 border rounded" x-text="page"></button>
                            </template>
                            <button @click="currentPage = Math.min(totalPages, currentPage + 1)" 
                                    :disabled="currentPage === totalPages || totalPages === 0"
                                    :class="{'opacity-50 cursor-not-allowed': currentPage === totalPages || totalPages === 0}"
                                    class="px-3 py-1 border rounded hover:bg-gray-100">
                                <i class="bi bi-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Item Details Modal -->
            <div x-show="showItemDetails" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40">
                <div class="bg-white rounded-lg shadow-lg p-6 max-w-md w-full mx-4" @click.away="showItemDetails = false">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" x-text="selectedItem.name"></h3>
                        <button @click="showItemDetails = false" class="text-gray-500 hover:text-gray-700">
                            <i class="bi bi-x-lg"></i>
                        </button>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between border-b pb-2">
                            <span class="font-medium">ID:</span>
                            <span x-text="selectedItem.id"></span>
                        </div>
                        <div class="flex justify-between border-b pb-2">
                            <span class="font-medium">Quantity:</span>
                            <span x-text="selectedItem.quantity"></span>
                        </div>
                        <div class="flex justify-between border-b pb-2">
                            <span class="font-medium">Status:</span>
                            <span :class="{
                                'text-green-600': selectedItem.quantity > 10,
                                'text-yellow-600': selectedItem.quantity <= 10 && selectedItem.quantity > 0,
                                'text-red-600': selectedItem.quantity === 0
                            }" x-text="selectedItem.quantity > 10 ? 'In Stock' : selectedItem.quantity === 0 ? 'Out of Stock' : 'Low Stock'"></span>
                        </div>
                        <div class="flex justify-between border-b pb-2">
                            <span class="font-medium">Last Updated:</span>
                            <span x-text="new Date().toLocaleDateString()"></span>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end space-x-2">
                        <button @click="editItem(selectedItem); showItemDetails = false" 
                                class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                            Edit Item
                        </button>
                        <button @click="showItemDetails = false" 
                                class="px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300">
                            Close
                        </button>
                    </div>
                </div>
            </div>

            <!-- Add/Edit Item Form -->
            <div x-show="currentView === 'add'" class="max-w-2xl mx-auto">
                <div class="bg-white shadow-md rounded-lg p-6">
                    <h2 class="text-2xl font-semibold mb-6" x-text="editingItem ? 'Edit Item' : 'Add New Item'"></h2>
                    <form @submit.prevent="saveItem" class="space-y-4">
                        <div>
                            <label class="block mb-2 font-medium">Name</label>
                            <input type="text" x-model="newItem.name" required
                                   placeholder="Enter item name"
                                   class="w-full border p-3 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <p class="text-sm text-gray-500 mt-1">Provide a clear and descriptive name for the heat exchanger item</p>
                        </div>
                        <div>
                            <label class="block mb-2 font-medium">Quantity</label>
                            <input type="number" x-model="newItem.quantity" required min="0"
                                   placeholder="Enter quantity"
                                   class="w-full border p-3 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <p class="text-sm text-gray-500 mt-1">Current stock quantity (minimum 0)</p>
                        </div>
                        <div>
                            <label class="block mb-2 font-medium">Category</label>
                            <select x-model="newItem.category" class="w-full border p-3 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">Select Category</option>
                                <option value="plate">Plate Heat Exchangers</option>
                                <option value="shell">Shell & Tube Heat Exchangers</option>
                                <option value="air">Air-Cooled Heat Exchangers</option>
                                <option value="parts">Spare Parts</option>
                                <option value="tools">Maintenance Tools</option>
                            </select>
                        </div>
                        <div>
                            <label class="block mb-2 font-medium">Description</label>
                            <textarea x-model="newItem.description" rows="3"
                                      placeholder="Enter description (optional)"
                                      class="w-full border p-3 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <div class="pt-4 border-t">
                            <button type="submit" 
                                    class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                                <span x-text="editingItem ? 'Update Item' : 'Add Item'"></span>
                            </button>
                            <button type="button" @click="resetForm(); currentView = 'inventory'" 
                                    class="ml-2 bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Reports View -->
            <div x-show="currentView === 'reports'" class="space-y-6">
                <h2 class="text-2xl font-semibold mb-4">Inventory Reports</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white p-4 rounded-lg shadow">
                        <h3 class="text-lg font-semibold mb-2">Total Items</h3>
                        <p class="text-3xl font-bold text-blue-600" x-text="totalItems"></p>
                        <p class="text-sm text-gray-500 mt-2">Total unique products in inventory</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow">
                        <h3 class="text-lg font-semibold mb-2">Low Stock Items</h3>
                        <p class="text-3xl font-bold text-yellow-600" x-text="lowStockItems"></p>
                        <p class="text-sm text-gray-500 mt-2">Items with quantity 10 or below</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow">
                        <h3 class="text-lg font-semibold mb-2">Out of Stock</h3>
                        <p class="text-3xl font-bold text-red-600" x-text="outOfStockItems"></p>
                        <p class="text-sm text-gray-500 mt-2">Items with zero quantity</p>
                    </div>
                </div>

                <!-- Stock Level Chart -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4">Stock Level Chart</h3>
                    <div class="h-64 bg-gray-50 rounded flex items-end justify-around p-4 border">
                        <template x-for="(item, index) in inventoryItems.slice(0, 5)" :key="index">
                            <div class="flex flex-col items-center">
                                <div class="w-16 bg-blue-500 rounded-t transition-all duration-500 ease-out" 
                                     :style="`height: ${maxQuantity ? (item.quantity / maxQuantity) * 200 : 0}px`"></div>
                                <span class="mt-2 text-sm text-center" x-text="item.name"></span>
                            </div>
                        </template>
                    </div>
                    <p class="text-sm text-gray-500 mt-4 text-center">Stock levels for top 5 items</p>
                </div>

                <!-- Category Distribution -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4">Category Distribution</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="border rounded-lg p-4">
                            <h4 class="font-medium text-gray-700 mb-3">Items by Category</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between items-center">
                                    <span>Plate Heat Exchangers</span>
                                    <span class="font-semibold" x-text="getCategoryCount('plate')"></span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span>Shell & Tube Heat Exchangers</span>
                                    <span class="font-semibold" x-text="getCategoryCount('shell')"></span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span>Air-Cooled Heat Exchangers</span>
                                    <span class="font-semibold" x-text="getCategoryCount('air')"></span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span>Spare Parts</span>
                                    <span class="font-semibold" x-text="getCategoryCount('parts')"></span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span>Maintenance Tools</span>
                                    <span class="font-semibold" x-text="getCategoryCount('tools')"></span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span>Uncategorized</span>
                                    <span class="font-semibold" x-text="getUncategorizedCount()"></span>
                                </div>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4">
                            <h4 class="font-medium text-gray-700 mb-3">Stock Status</h4>
                            <div class="space-y-3">
                                <div>
                                    <p class="mb-1 flex justify-between">
                                        <span>In Stock</span>
                                        <span class="font-semibold" x-text="inStockItems"></span>
                                    </p>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div class="bg-green-500 h-2.5 rounded-full" :style="`width: ${(inStockItems / totalItems) * 100}%`"></div>
                                    </div>
                                </div>
                                <div>
                                    <p class="mb-1 flex justify-between">
                                        <span>Low Stock</span>
                                        <span class="font-semibold" x-text="lowStockItems"></span>
                                    </p>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div class="bg-yellow-500 h-2.5 rounded-full" :style="`width: ${(lowStockItems / totalItems) * 100}%`"></div>
                                    </div>
                                </div>
                                <div>
                                    <p class="mb-1 flex justify-between">
                                        <span>Out of Stock</span>
                                        <span class="font-semibold" x-text="outOfStockItems"></span>
                                    </p>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div class="bg-red-500 h-2.5 rounded-full" :style="`width: ${(outOfStockItems / totalItems) * 100}%`"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Export Options -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4">Export Reports</h3>
                    <div class="flex flex-wrap gap-3">
                        <button @click="exportData('csv')" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 flex items-center gap-2">
                            <i class="bi bi-file-earmark-spreadsheet"></i> Export as CSV
                        </button>
                        <button @click="exportData('pdf')" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 flex items-center gap-2">
                            <i class="bi bi-file-earmark-pdf"></i> Export as PDF
                        </button>
                        <button @click="exportData('print')" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-2">
                            <i class="bi bi-printer"></i> Print Report
                        </button>
                    </div>
                </div>
            </div>

            <!-- Bulk Operations -->
            <div x-show="currentView === 'bulk'" class="space-y-6">
                <h2 class="text-2xl font-semibold mb-4">Bulk Operations</h2>
                
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4">Bulk Update Quantities</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block mb-2 font-medium">Update Type</label>
                            <select x-model="bulkOperation.type" class="w-full border p-3 rounded">
                                <option value="increase">Increase Quantities</option>
                                <option value="decrease">Decrease Quantities</option>
                                <option value="set">Set to Specific Value</option>
                            </select>
                        </div>

                        <div>
                            <label class="block mb-2 font-medium">Value</label>
                            <input type="number" x-model="bulkOperation.value" min="0" 
                                   :placeholder="bulkOperation.type === 'set' ? 'New quantity value' : 'Amount to adjust'"
                                   class="w-full border p-3 rounded">
                        </div>

                        <div>
                            <label class="block mb-2 font-medium">Apply To</label>
                            <select x-model="bulkOperation.target" class="w-full border p-3 rounded">
                                <option value="all">All Items</option>
                                <option value="category">Specific Category</option>
                                <option value="selection">Selected Items</option>
                            </select>
                        </div>

                        <div x-show="bulkOperation.target === 'category'">
                            <label class="block mb-2 font-medium">Select Category</label>
                            <select x-model="bulkOperation.category" class="w-full border p-3 rounded">
                                <option value="plate">Plate Heat Exchangers</option>
                                <option value="shell">Shell & Tube Heat Exchangers</option>
                                <option value="air">Air-Cooled Heat Exchangers</option>
                                <option value="parts">Spare Parts</option>
                                <option value="tools">Maintenance Tools</option>
                            </select>
                        </div>

                        <div x-show="bulkOperation.target === 'selection'">
                            <label class="block mb-2 font-medium">Select Items</label>
                            <div class="max-h-60 overflow-y-auto border p-3 rounded">
                                <template x-for="item in inventoryItems" :key="item.id">
                                    <div class="flex items-center p-2 hover:bg-gray-50">
                                        <input type="checkbox" 
                                               :value="item.id" 
                                               :id="`item-${item.id}`" 
                                               x-model="bulkOperation.selectedItems" 
                                               class="mr-2">
                                        <label :for="`item-${item.id}`" x-text="item.name"></label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="pt-4">
                            <button @click="executeBulkOperation" 
                                    :disabled="!bulkOperation.value || (bulkOperation.target === 'selection' && bulkOperation.selectedItems.length === 0)" 
                                    :class="{'opacity-50 cursor-not-allowed': !bulkOperation.value || (bulkOperation.target === 'selection' && bulkOperation.selectedItems.length === 0)}"
                                    class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                                Apply Changes
                            </button>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4">Import/Export Data</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-medium mb-3">Import Inventory</h4>
                            <p class="text-sm text-gray-600 mb-4">Upload a CSV file to import inventory data</p>
                            <label class="block w-full border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-blue-500">
                                <input type="file" accept=".csv" class="hidden" @change="handleFileUpload">
                                <i class="bi bi-cloud-arrow-up-fill text-4xl text-gray-400 mb-3 block"></i>
                                <span class="text-gray-500">Click to select or drop a file</span>
                            </label>
                        </div>
                        <div>
                            <h4 class="font-medium mb-3">Export Inventory</h4>
                            <p class="text-sm text-gray-600 mb-4">Download your complete inventory data</p>
                            <button @click="exportData('csv')" class="block w-full p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 mb-3 flex items-center justify-center gap-2">
                                <i class="bi bi-file-earmark-spreadsheet"></i> Export as CSV
                            </button>
                            <button @click="exportData('json')" class="block w-full p-4 bg-gray-700 text-white rounded-lg hover:bg-gray-800 flex items-center justify-center gap-2">
                                <i class="bi bi-filetype-json"></i> Export as JSON
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div x-show="currentView === 'settings'" class="space-y-6">
                <h2 class="text-2xl font-semibold mb-4">Settings</h2>
                
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4">Application Settings</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block mb-2 font-medium">Company Name</label>
                            <input type="text" x-model="settings.companyName" placeholder="HE Shop" class="w-full border p-3 rounded">
                        </div>
                        <div>
                            <label class="block mb-2 font-medium">Low Stock Threshold</label>
                            <input type="number" x-model="settings.lowStockThreshold" min="1" class="w-full border p-3 rounded">
                            <p class="text-sm text-gray-500 mt-1">Items with quantity below this value will be marked as low stock</p>
                        </div>
                        <div>
                            <label class="block mb-2 font-medium">Calendar View</label>
                            <select x-model="settings.calendar" class="w-full border p-3 rounded">
                                <option value="monthly">Monthly</option>
                                <option value="weekly">Weekly</option>
                                <option value="daily">Daily</option>
                            </select>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="notificationsToggle" x-model="settings.enableNotifications" class="mr-2">
                            <label for="notificationsToggle" class="font-medium">Enable Low Stock Notifications</label>
                        </div>
                        <div class="pt-4 border-t">
                            <button @click="saveSettings" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                                Save Settings
                            </button>
                            <button @click="resetSettings" class="ml-2 bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300">
                                Reset to Defaults
                            </button>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4">API Settings</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block mb-2 font-medium">API Endpoint</label>
                            <input type="text" value="HEAT EXCHANGER" disabled class="w-full border p-3 rounded bg-gray-100">
                        </div>
                        <div>
                            <label class="block mb-2 font-medium">API Key</label>
                            <div class="relative">
                                <input :type="showApiKey ? 'text' : 'password'" value="Viney@1234" disabled class="w-full border p-3 rounded bg-gray-100">
                                <button @click="showApiKey = !showApiKey" class="absolute right-3 top-1/2 transform -translate-y-1/2">
                                    <i :class="showApiKey ? 'bi-eye-slash' : 'bi-eye'" class="text-gray-500"></i>
                                </button>
                            </div>
                        </div>
                        <div class="pt-4 border-t">
                            <button class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 disabled opacity-50 cursor-not-allowed">
                                Refresh API Key
                            </button>
                            <button class="ml-2 bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300 disabled opacity-50 cursor-not-allowed">
                                Test Connection
                            </button>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4">About</h3>
                    <p class="mb-2">HE Shop Inventory Management System v1.0.0</p>
                    <p class="text-gray-600">Specialized inventory management for heat exchanger products</p>
                    <div class="mt-4 pt-4 border-t text-sm text-gray-500">
                        <p>© 2023 HE Shop. All rights reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function inventoryApp() {
            return {
                sidebarOpen: window.innerWidth >= 1024, // Open by default on large screens
                currentView: 'inventory',
                loading: false,
                searchQuery: '',
                searchTimeout: null,
                filterStatus: 'all',
                sortField: 'id',
                sortDirection: 'asc',
                currentPage: 1,
                itemsPerPage: 10,
                showApiKey: false,
                showItemDetails: false,
                selectedItem: {},
                
                inventoryItems: [],
                editingItem: null,
                newItem: {
                    name: '',
                    quantity: 0,
                    category: '',
                    description: ''
                },
                
                bulkOperation: {
                    type: 'increase',
                    value: '',
                    target: 'all',
                    category: 'plate',
                    selectedItems: []
                },

                settings: {
                    companyName: 'HE Shop',
                    lowStockThreshold: 10,
                    calendar: 'monthly',
                    enableNotifications: true
                },

                toast: {
                    visible: false,
                    type: 'success',
                    message: '',
                    timeout: null
                },

                init() {
                    this.refreshInventory();
                    
                    // Handle responsive sidebar
                    window.addEventListener('resize', () => {
                        if (window.innerWidth >= 1024) {
                            this.sidebarOpen = true;
                        }
                    });
                },

                showToast(message, type = 'success') {
                    if (this.toast.timeout) {
                        clearTimeout(this.toast.timeout);
                    }
                    
                    this.toast.message = message;
                    this.toast.type = type;
                    this.toast.visible = true;
                    
                    this.toast.timeout = setTimeout(() => {
                        this.toast.visible = false;
                    }, 3000);
                },

                debounceSearch() {
                    if (this.searchTimeout) {
                        clearTimeout(this.searchTimeout);
                    }
                    
                    this.searchTimeout = setTimeout(() => {
                        this.currentPage = 1;
                    }, 300);
                },

                async refreshInventory() {
                    this.loading = true;
                    try {
                        // Simulated API call with enhanced data
                        await new Promise(resolve => setTimeout(resolve, 800));
                        this.inventoryItems = [
                            { id: 1, name: "Plate Heat Exchanger Type A", quantity: 15, category: "plate", description: "Industrial grade plate heat exchanger for HVAC systems" },
                            { id: 2, name: "Shell & Tube HE Model 200", quantity: 8, category: "shell", description: "High capacity shell and tube heat exchanger" },
                            { id: 3, name: "Air-Cooled Heat Exchanger", quantity: 0, category: "air", description: "Compact air-cooled heat exchanger for small applications" },
                            { id: 4, name: "Spare Gasket Kit", quantity: 25, category: "parts", description: "Replacement gaskets for plate heat exchangers" },
                            { id: 5, name: "HE Maintenance Tools Set", quantity: 12, category: "tools", description: "Complete toolset for heat exchanger maintenance" },
                            { id: 6, name: "Plate Heat Exchanger Type B", quantity: 5, category: "plate", description: "Compact plate heat exchanger for residential use" },
                            { id: 7, name: "Shell & Tube HE Model 300", quantity: 3, category: "shell", description: "Heavy-duty shell and tube heat exchanger" },
                            { id: 8, name: "Air-Cooled Condenser", quantity: 9, category: "air", description: "Industrial air-cooled condenser unit" },
                            { id: 9, name: "Plate Pack Replacement", quantity: 0, category: "parts", description: "Complete plate pack replacements for PHE Type A" },
                            { id: 10, name: "HE Cleaning System", quantity: 7, category: "tools", description: "Chemical cleaning system for heat exchangers" }
                        ];
                        this.showToast('Inventory data refreshed successfully');
                    } catch (error) {
                        console.error('Error fetching inventory:', error);
                        this.showToast('Failed to fetch inventory items', 'error');
                    } finally {
                        this.loading = false;
                    }
                },

                applyFilters() {
                    this.currentPage = 1;
                },

                sortItems(field) {
                    if (this.sortField === field) {
                        this.sortDirection = this.sortDirection === 'asc' ? 'desc' : 'asc';
                    } else {
                        this.sortField = field;
                        this.sortDirection = 'asc';
                    }
                },

                get filteredItems() {
                    let items = [...this.inventoryItems];
                    
                    // Apply search filter
                    if (this.searchQuery) {
                        const query = this.searchQuery.toLowerCase();
                        items = items.filter(item => 
                            item.name.toLowerCase().includes(query) || 
                            item.id.toString().includes(query) ||
                            (item.category && item.category.toLowerCase().includes(query)) ||
                            (item.description && item.description.toLowerCase().includes(query))
                        );
                    }
                    
                    // Apply status filter
                    if (this.filterStatus !== 'all') {
                        switch(this.filterStatus) {
                            case 'in-stock':
                                items = items.filter(item => item.quantity > 10);
                                break;
                            case 'low-stock':
                                items = items.filter(item => item.quantity > 0 && item.quantity <= 10);
                                break;
                            case 'out-of-stock':
                                items = items.filter(item => item.quantity === 0);
                                break;
                        }
                    }
                    
                    // Apply sorting
                    items.sort((a, b) => {
                        let valueA = a[this.sortField];
                        let valueB = b[this.sortField];
                        
                        // Handle string comparison
                        if (typeof valueA === 'string') {
                            valueA = valueA.toLowerCase();
                            valueB = valueB.toLowerCase();
                        }
                        
                        if (valueA < valueB) return this.sortDirection === 'asc' ? -1 : 1;
                        if (valueA > valueB) return this.sortDirection === 'asc' ? 1 : -1;
                        return 0;
                    });
                    
                    return items;
                },

                get paginatedItems() {
                    const start = (this.currentPage - 1) * this.itemsPerPage;
                    const end = start + this.itemsPerPage;
                    return this.filteredItems.slice(start, end);
                },
                
                get totalPages() {
                    return Math.max(1, Math.ceil(this.filteredItems.length / this.itemsPerPage));
                },

                get totalItems() {
                    return this.inventoryItems.length;
                },

                get lowStockItems() {
                    return this.inventoryItems.filter(item => item.quantity > 0 && item.quantity <= this.settings.lowStockThreshold).length;
                },

                get outOfStockItems() {
                    return this.inventoryItems.filter(item => item.quantity === 0).length;
                },

                get inStockItems() {
                    return this.inventoryItems.filter(item => item.quantity > this.settings.lowStockThreshold).length;
                },

                get maxQuantity() {
                    if (this.inventoryItems.length === 0) return 0;
                    return Math.max(...this.inventoryItems.map(item => item.quantity));
                },

                async quickUpdateQuantity(item, change) {
                    if (item.quantity + change < 0) return;
                    
                    this.loading = true;
                    try {
                        // Simulated API call
                        await new Promise(resolve => setTimeout(resolve, 500));
                        const index = this.inventoryItems.findIndex(i => i.id === item.id);
                        this.inventoryItems[index].quantity += change;
                        
                        this.showToast(`Updated quantity for ${item.name}`);
                    } catch (error) {
                        console.error('Error updating quantity:', error);
                        this.showToast('Failed to update quantity', 'error');
                    } finally {
                        this.loading = false;
                    }
                },

                editItem(item) {
                    this.editingItem = item;
                    this.newItem = { ...item };
                    this.currentView = 'add';
                },
                
                viewItemDetails(item) {
                    this.selectedItem = item;
                    this.showItemDetails = true;
                },

                async deleteItem(id) {
                    if (!confirm('Are you sure you want to delete this item?')) return;

                    this.loading = true;
                    try {
                        // Simulated API call
                        await new Promise(resolve => setTimeout(resolve, 800));
                        const itemName = this.inventoryItems.find(item => item.id === id)?.name || 'Item';
                        this.inventoryItems = this.inventoryItems.filter(item => item.id !== id);
                        this.showToast(`${itemName} has been deleted`);
                    } catch (error) {
                        console.error('Error deleting item:', error);
                        this.showToast('Failed to delete item', 'error');
                    } finally {
                        this.loading = false;
                    }
                },

                async saveItem() {
                    this.loading = true;
                    try {
                        // Simulated API call
                        await new Promise(resolve => setTimeout(resolve, 800));
                        
                        if (this.editingItem) {
                            const index = this.inventoryItems.findIndex(item => item.id === this.editingItem.id);
                            this.inventoryItems[index] = { ...this.editingItem, ...this.newItem };
                            this.showToast(`Updated ${this.newItem.name} successfully`);
                        } else {
                            const newId = this.inventoryItems.length > 0 ? 
                                        Math.max(...this.inventoryItems.map(item => item.id)) + 1 : 1;
                            this.inventoryItems.push({ id: newId, ...this.newItem });
                            this.showToast(`Added ${this.newItem.name} to inventory`);
                        }

                        this.resetForm();
                        this.currentView = 'inventory';
                    } catch (error) {
                        console.error('Error saving item:', error);
                        this.showToast('Failed to save item', 'error');
                    } finally {
                        this.loading = false;
                    }
                },

                resetForm() {
                    this.newItem = {
                        name: '',
                        quantity: 0,
                        category: '',
                        description: ''
                    };
                    this.editingItem = null;
                },
                
                getCategoryCount(category) {
                    return this.inventoryItems.filter(item => item.category === category).length;
                },
                
                getUncategorizedCount() {
                    return this.inventoryItems.filter(item => !item.category).length;
                },

                generateReports() {
                    // This would typically fetch additional report data
                    console.log('Generating reports data');
                },
                
                exportData(format) {
                    this.loading = true;
                    
                    setTimeout(() => {
                        this.loading = false;
                        this.showToast(`Data exported as ${format.toUpperCase()} format`);
                    }, 1000);
                    
                    // In a real app, this would handle the actual export
                    console.log(`Exporting data in ${format} format`);
                },
                
                handleFileUpload(event) {
                    const file = event.target.files[0];
                    if (!file) return;
                    
                    this.loading = true;
                    
                    // Simulate file processing
                    setTimeout(() => {
                        this.loading = false;
                        this.showToast(`File "${file.name}" processed successfully`, 'success');
                    }, 1500);
                },
                
                async executeBulkOperation() {
                    if (!this.bulkOperation.value) {
                        this.showToast('Please enter a valid value', 'error');
                        return;
                    }
                    
                    this.loading = true;
                    
                    try {
                        // Simulated API call
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        
                        let itemsToUpdate = [];
                        const value = parseInt(this.bulkOperation.value);
                        
                        switch (this.bulkOperation.target) {
                            case 'all':
                                itemsToUpdate = [...this.inventoryItems];
                                break;
                            case 'category':
                                itemsToUpdate = this.inventoryItems.filter(item => 
                                    item.category === this.bulkOperation.category
                                );
                                break;
                            case 'selection':
                                if (this.bulkOperation.selectedItems.length === 0) {
                                    throw new Error('No items selected');
                                }
                                itemsToUpdate = this.inventoryItems.filter(item => 
                                    this.bulkOperation.selectedItems.includes(item.id)
                                );
                                break;
                        }
                        
                        let updateCount = 0;
                        
                        itemsToUpdate.forEach(item => {
                            const index = this.inventoryItems.findIndex(i => i.id === item.id);
                            if (index === -1) return;
                            
                            switch (this.bulkOperation.type) {
                                case 'increase':
                                    this.inventoryItems[index].quantity += value;
                                    break;
                                case 'decrease':
                                    this.inventoryItems[index].quantity = Math.max(0, this.inventoryItems[index].quantity - value);
                                    break;
                                case 'set':
                                    this.inventoryItems[index].quantity = value;
                                    break;
                            }
                            updateCount++;
                        });
                        
                        // Reset selection after operation
                        this.bulkOperation.selectedItems = [];
                        
                        this.showToast(`Updated ${updateCount} items successfully`);
                    } catch (error) {
                        console.error('Error in bulk operation:', error);
                        this.showToast(error.message || 'Failed to update items', 'error');
                    } finally {
                        this.loading = false;
                    }
                },
                
                saveSettings() {
                    this.loading = true;
                    
                    setTimeout(() => {
                        this.loading = false;
                        this.showToast('Settings saved successfully');
                    }, 800);
                },
                
                resetSettings() {
                    this.settings = {
                        companyName: 'HE Shop',
                        lowStockThreshold: 10,
                        calendar: 'monthly',
                        enableNotifications: true
                    };
                    
                    this.showToast('Settings reset to defaults');
                }
            };
        }
    </script>
<script>document.body.addEventListener('wheel', e => { if (!e.ctrlKey) return; e.preventDefault(); return }, { passive: false })</script>
	</body>
</html>